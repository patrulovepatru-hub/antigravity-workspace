â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                    â•‘
â•‘   ğŸŸªğŸŸªğŸŸª TUTORIAL DE EXPLOTACIÃ“N - BSC GENESIS CONTRACTS ğŸŸªğŸŸªğŸŸª                  â•‘
â•‘                                                                                    â•‘
â•‘   Target: Binance Smart Chain Bug Bounty                                          â•‘
â•‘   Bounty Range: $500 - $100,000 USD                                               â•‘
â•‘   Auditor: l0ve                                                                   â•‘
â•‘   Fecha: 2026-01-07                                                               â•‘
â•‘                                                                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 ÃNDICE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. SETUP DEL ENTORNO
2. VULNERABILIDADES ENCONTRADAS (ORDENADAS POR PAGO POTENCIAL)
3. EXPLOITS DESARROLLADOS
4. CÃ“MO EJECUTAR LOS TESTS
5. CÃ“MO REPORTAR AL BUG BOUNTY
6. RECOMENDACIONES DE REMEDIACIÃ“N

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 1. SETUP DEL ENTORNO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸŸª PASO 1: Instalar Foundry (framework de testing para Solidity)

    curl -L https://foundry.paradigm.xyz | bash
    foundryup

ğŸŸª PASO 2: Clonar el repositorio (ya hecho)

    cd /home/l0ve/pen-test/binance/bsc-genesis-contract

ğŸŸª PASO 3: Instalar dependencias

    forge install

ğŸŸª PASO 4: Compilar contratos

    forge build

ğŸŸª PASO 5: Ejecutar tests existentes

    forge test -vvv

ğŸŸª PASO 6: Fork de BSC Mainnet para testing realista

    # Necesitas un RPC de BSC (puedes usar Ankr, QuickNode, etc.)
    export BSC_RPC="https://bsc-dataseed.binance.org/"

    # Ejecutar tests contra fork
    forge test --fork-url $BSC_RPC -vvv

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 2. VULNERABILIDADES ENCONTRADAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ CRÃTICA #1: Reentrancy en StakeHub.redelegate()                             â”‚
â”‚ Archivo: contracts/StakeHub.sol:553-599                                        â”‚
â”‚ Bounty Estimado: $50,000 - $100,000                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚ EXPLICACIÃ“N:                                                                   â”‚
â”‚ La funciÃ³n redelegate() hace 3 llamadas externas antes de completar           â”‚
â”‚ cambios de estado:                                                             â”‚
â”‚                                                                                â”‚
â”‚   1. unbond() â†’ Retorna BNB al StakeHub                                        â”‚
â”‚   2. call{value: feeCharge}("") â†’ EnvÃ­a fee al creditContract destino          â”‚
â”‚   3. delegate() â†’ Delega al nuevo validador                                    â”‚
â”‚                                                                                â”‚
â”‚ Si el creditContract destino es malicioso, puede reentrar en el paso 2.       â”‚
â”‚                                                                                â”‚
â”‚ IMPACTO:                                                                       â”‚
â”‚ - Robo de fondos de staking                                                    â”‚
â”‚ - ManipulaciÃ³n de shares                                                       â”‚
â”‚ - DisrupciÃ³n econÃ³mica de validadores                                          â”‚
â”‚                                                                                â”‚
â”‚ EXPLOIT: exploits/ReentrancyExploit.sol                                        â”‚
â”‚                                                                                â”‚
â”‚ POR QUÃ‰ PAGA BIEN:                                                             â”‚
â”‚ â†’ Afecta directamente los fondos de usuarios                                   â”‚
â”‚ â†’ Es explotable en condiciones reales                                          â”‚
â”‚ â†’ El impacto econÃ³mico es cuantificable y alto                                 â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”´ CRÃTICA #2: Flash Loan Governance Attack                                    â”‚
â”‚ Archivo: contracts/GovToken.sol + contracts/StakeHub.sol                       â”‚
â”‚ Bounty Estimado: $75,000 - $100,000                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚ EXPLICACIÃ“N:                                                                   â”‚
â”‚ El GovToken otorga poder de voto basado en BNB stakeado.                       â”‚
â”‚ Vector de ataque:                                                              â”‚
â”‚                                                                                â”‚
â”‚   1. Flash loan de grandes cantidades de BNB                                   â”‚
â”‚   2. Delegate al validador (obtener shares)                                    â”‚
â”‚   3. Sync GovToken (obtener voting power)                                      â”‚
â”‚   4. Votar en propuesta de governance                                          â”‚
â”‚   5. Undelegate y devolver flash loan                                          â”‚
â”‚                                                                                â”‚
â”‚ El unbondPeriod de 7 dÃ­as DEBERÃA prevenir esto, pero hay que verificar       â”‚
â”‚ si existe bypass vÃ­a redelegate() u otros mecanismos.                          â”‚
â”‚                                                                                â”‚
â”‚ IMPACTO:                                                                       â”‚
â”‚ - Aprobar propuestas maliciosas                                                â”‚
â”‚ - Drenar treasury                                                              â”‚
â”‚ - Modificar parÃ¡metros crÃ­ticos del protocolo                                  â”‚
â”‚ - Cambiar direcciones de contratos del sistema                                 â”‚
â”‚                                                                                â”‚
â”‚ EXPLOIT: exploits/FlashLoanGovernanceExploit.sol                               â”‚
â”‚                                                                                â”‚
â”‚ POR QUÃ‰ PAGA BIEN:                                                             â”‚
â”‚ â†’ Compromete la gobernanza completa del protocolo                              â”‚
â”‚ â†’ Puede resultar en pÃ©rdida masiva de fondos                                   â”‚
â”‚ â†’ Afecta la descentralizaciÃ³n de la red                                        â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŸ  ALTA #3: Unchecked Return Value en distributeReward()                       â”‚
â”‚ Archivo: contracts/StakeHub.sol:656                                            â”‚
â”‚ Bounty Estimado: $10,000 - $50,000                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚ CÃ“DIGO VULNERABLE:                                                             â”‚
â”‚                                                                                â”‚
â”‚   SYSTEM_REWARD_ADDR.call{ value: msg.value }("");  // âš ï¸ Sin verificar!      â”‚
â”‚                                                                                â”‚
â”‚ EXPLICACIÃ“N:                                                                   â”‚
â”‚ Si esta llamada falla, los fondos quedan atrapados en StakeHub sin            â”‚
â”‚ posibilidad de recuperaciÃ³n. No hay error, no hay revert.                      â”‚
â”‚                                                                                â”‚
â”‚ ESCENARIOS DE FALLO:                                                           â”‚
â”‚ - SYSTEM_REWARD_ADDR tiene receive() que revierte                              â”‚
â”‚ - CongestiÃ³n de red causa out-of-gas                                           â”‚
â”‚ - Upgrade del contrato destino con lÃ³gica incompatible                         â”‚
â”‚                                                                                â”‚
â”‚ IMPACTO:                                                                       â”‚
â”‚ - PÃ©rdida permanente de recompensas de staking                                 â”‚
â”‚ - Validadores pierden ingresos                                                 â”‚
â”‚ - "Ghost funds" que nadie puede reclamar                                       â”‚
â”‚                                                                                â”‚
â”‚ EXPLOIT: exploits/UncheckedReturnExploit.sol                                   â”‚
â”‚                                                                                â”‚
â”‚ POR QUÃ‰ PAGA BIEN:                                                             â”‚
â”‚ â†’ Es un error de cÃ³digo claro y demostrable                                    â”‚
â”‚ â†’ La soluciÃ³n es simple (verificar return value)                               â”‚
â”‚ â†’ Impacto potencial en producciÃ³n                                              â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŸ  ALTA #4: Slash Reward Manipulation                                          â”‚
â”‚ Archivo: contracts/SlashIndicator.sol:260                                      â”‚
â”‚ Bounty Estimado: $10,000 - $25,000                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚ CÃ“DIGO VULNERABLE:                                                             â”‚
â”‚                                                                                â”‚
â”‚   uint256 amount = (address(SYSTEM_REWARD_ADDR).balance *                      â”‚
â”‚                     felonySlashRewardRatio) / 100;                             â”‚
â”‚                                                                                â”‚
â”‚ EXPLICACIÃ“N:                                                                   â”‚
â”‚ La recompensa por reportar slashing se calcula como % del balance             â”‚
â”‚ de SYSTEM_REWARD_ADDR. Un atacante puede:                                      â”‚
â”‚                                                                                â”‚
â”‚   1. Enviar BNB a SYSTEM_REWARD_ADDR (inflar balance)                          â”‚
â”‚   2. Reportar evidencia vÃ¡lida de slashing                                     â”‚
â”‚   3. Recibir recompensa inflada (20% del balance inflado)                      â”‚
â”‚                                                                                â”‚
â”‚ VECTOR REAL:                                                                   â”‚
â”‚ - Front-running: Detectar tx de slashing en mempool                            â”‚
â”‚ - Donar justo antes de que se procese                                          â”‚
â”‚ - El slasher original recibe mÃ¡s de lo esperado                                â”‚
â”‚                                                                                â”‚
â”‚ EXPLOIT: exploits/SlashRewardManipulation.sol                                  â”‚
â”‚                                                                                â”‚
â”‚ POR QUÃ‰ PAGA BIEN:                                                             â”‚
â”‚ â†’ Afecta la economÃ­a del sistema de slashing                                   â”‚
â”‚ â†’ Puede drenar el pool de recompensas del sistema                              â”‚
â”‚ â†’ Demuestra falta de controles econÃ³micos                                      â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŸ¡ MEDIA #5: Token Recovery Lock Extension Attack                              â”‚
â”‚ Archivo: contracts/TokenHub.sol:230-236                                        â”‚
â”‚ Bounty Estimado: $5,000 - $15,000                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚ CÃ“DIGO VULNERABLE:                                                             â”‚
â”‚                                                                                â”‚
â”‚   function _lockRecoverToken(...) internal {                                   â”‚
â”‚       lockInfo.amount = lockInfo.amount.add(amount);                           â”‚
â”‚       lockInfo.unlockAt = block.timestamp + LOCK_PERIOD_FOR_TOKEN_RECOVER;     â”‚
â”‚   }                                                                            â”‚
â”‚                                                                                â”‚
â”‚ EXPLICACIÃ“N:                                                                   â”‚
â”‚ Cada recovery RESETEA el unlockAt. Un atacante puede:                          â”‚
â”‚                                                                                â”‚
â”‚   1. Esperar a que vÃ­ctima inicie recovery                                     â”‚
â”‚   2. Antes de 7 dÃ­as, iniciar otra recovery para la vÃ­ctima                    â”‚
â”‚   3. Esto resetea el timer de 7 dÃ­as                                           â”‚
â”‚   4. Repetir indefinidamente = fondos bloqueados para siempre                  â”‚
â”‚                                                                                â”‚
â”‚ IMPACTO:                                                                       â”‚
â”‚ - DoS permanente en token recovery                                             â”‚
â”‚ - VÃ­ctimas no pueden acceder a sus fondos migrados                             â”‚
â”‚ - Ataque de griefing con costo mÃ­nimo                                          â”‚
â”‚                                                                                â”‚
â”‚ EXPLOIT: exploits/TokenRecoveryTimingAttack.sol                                â”‚
â”‚                                                                                â”‚
â”‚ POR QUÃ‰ PAGA:                                                                  â”‚
â”‚ â†’ Afecta usuarios reales del sistema de migraciÃ³n                              â”‚
â”‚ â†’ Es un DoS que no requiere grandes recursos                                   â”‚
â”‚ â†’ Impacta la usabilidad del protocolo                                          â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 3. CÃ“MO EJECUTAR LOS EXPLOITS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸŸª PASO 1: Copiar exploits al directorio de tests

    cp /home/l0ve/pen-test/binance/exploits/*.sol \
       /home/l0ve/pen-test/binance/bsc-genesis-contract/test/

ğŸŸª PASO 2: Crear test file para Foundry

    # Crear archivo de test
    cat > /home/l0ve/pen-test/binance/bsc-genesis-contract/test/Exploits.t.sol << 'EOF'
    // SPDX-License-Identifier: MIT
    pragma solidity 0.8.17;

    import "forge-std/Test.sol";
    import "./ReentrancyExploit.sol";
    import "./FlashLoanGovernanceExploit.sol";

    contract ExploitTest is Test {
        // Tests go here
    }
    EOF

ğŸŸª PASO 3: Ejecutar tests contra fork de BSC

    cd /home/l0ve/pen-test/binance/bsc-genesis-contract

    # Fork de mainnet BSC
    forge test --fork-url https://bsc-dataseed.binance.org/ -vvvv

ğŸŸª PASO 4: Generar reporte de gas

    forge test --gas-report

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 4. CÃ“MO REPORTAR AL BUG BOUNTY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸŸª OPCIÃ“N A: Binance Bugcrowd (Para web/API vulnerabilities)

    URL: https://bugcrowd.com/binance

    1. Crear cuenta en Bugcrowd
    2. Ir al programa de Binance
    3. Leer scope completo
    4. Crear reporte con:
       - TÃ­tulo descriptivo
       - DescripciÃ³n tÃ©cnica
       - Pasos de reproducciÃ³n
       - Proof of Concept (cÃ³digo)
       - Impacto estimado
       - Sugerencia de fix

ğŸŸª OPCIÃ“N B: BNB Chain Bug Bounty (Para smart contracts)

    URL: https://bugbounty.bnbchain.org/

    1. Preparar reporte tÃ©cnico
    2. Incluir PoC funcional
    3. Demostrar impacto con nÃºmeros
    4. Proponer remediaciÃ³n

ğŸŸª TEMPLATE DE REPORTE:

    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    TÃTULO: [Severity] - DescripciÃ³n corta
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    ## Resumen
    Breve descripciÃ³n de 2-3 lÃ­neas

    ## Componente Afectado
    - Contrato: StakeHub.sol
    - FunciÃ³n: redelegate()
    - LÃ­neas: 553-599

    ## DescripciÃ³n TÃ©cnica
    ExplicaciÃ³n detallada del bug...

    ## Pasos de ReproducciÃ³n
    1. Deploy MaliciousCreditContract
    2. Llamar startAttack() con 10 BNB
    3. Llamar executeRedelegate()
    4. Observar eventos de reentrancy

    ## Proof of Concept
    ```solidity
    // CÃ³digo del exploit
    ```

    ## Impacto
    - Severidad: CrÃ­tica
    - Fondos en riesgo: $X millones
    - Usuarios afectados: Todos los stakers

    ## RemediaciÃ³n Sugerida
    ```solidity
    // CÃ³digo con el fix
    ```
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 5. REMEDIACIONES SUGERIDAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸŸª FIX #1: Reentrancy en redelegate()

    // ANTES (vulnerable):
    uint256 bnbAmount = IStakeCredit(srcValInfo.creditContract).unbond(delegator, shares);
    (bool success,) = dstValInfo.creditContract.call{ value: feeCharge }("");

    // DESPUÃ‰S (seguro):
    // Agregar ReentrancyGuard
    function redelegate(...) external nonReentrant { ... }

    // O usar checks-effects-interactions:
    // 1. Hacer todos los checks
    // 2. Actualizar todo el estado
    // 3. Hacer llamadas externas al final

ğŸŸª FIX #2: Unchecked return value

    // ANTES (vulnerable):
    SYSTEM_REWARD_ADDR.call{ value: msg.value }("");

    // DESPUÃ‰S (seguro):
    (bool success,) = SYSTEM_REWARD_ADDR.call{ value: msg.value }("");
    require(success, "Transfer to SYSTEM_REWARD failed");

ğŸŸª FIX #3: Token recovery lock extension

    // ANTES (vulnerable):
    lockInfo.unlockAt = block.timestamp + LOCK_PERIOD_FOR_TOKEN_RECOVER;

    // DESPUÃ‰S (seguro):
    // Solo extender si el nuevo unlock es mayor
    uint256 newUnlock = block.timestamp + LOCK_PERIOD_FOR_TOKEN_RECOVER;
    if (newUnlock > lockInfo.unlockAt) {
        lockInfo.unlockAt = newUnlock;
    }
    // O mejor: no permitir mÃºltiples recoveries al mismo recipient

ğŸŸª FIX #4: Slash reward manipulation

    // ANTES (vulnerable):
    uint256 amount = (address(SYSTEM_REWARD_ADDR).balance * ratio) / 100;

    // DESPUÃ‰S (seguro):
    // Usar un valor fijo o snapshot del balance
    uint256 maxReward = 100 ether; // Cap fijo
    uint256 amount = (address(SYSTEM_REWARD_ADDR).balance * ratio) / 100;
    if (amount > maxReward) amount = maxReward;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 6. COMANDOS ÃšTILES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ver estructura de contratos
find /home/l0ve/pen-test/binance/bsc-genesis-contract/contracts -name "*.sol" | xargs wc -l

# Buscar patrones vulnerables
grep -rn "\.call{" /home/l0ve/pen-test/binance/bsc-genesis-contract/contracts/
grep -rn "transfer(" /home/l0ve/pen-test/binance/bsc-genesis-contract/contracts/
grep -rn "delegatecall" /home/l0ve/pen-test/binance/bsc-genesis-contract/contracts/

# Compilar con warnings
forge build --force 2>&1 | grep -i "warning"

# Ejecutar slither (anÃ¡lisis estÃ¡tico)
pip install slither-analyzer
slither /home/l0ve/pen-test/binance/bsc-genesis-contract/

# Ejecutar mythril (anÃ¡lisis simbÃ³lico)
pip install mythril
myth analyze /home/l0ve/pen-test/binance/bsc-genesis-contract/contracts/StakeHub.sol

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 DISCLAIMER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Este tutorial es SOLO para propÃ³sitos educativos y de investigaciÃ³n de seguridad
autorizada dentro del programa de bug bounty de Binance.

âŒ NO usar estos exploits en producciÃ³n sin autorizaciÃ³n
âŒ NO atacar sistemas sin permiso
âŒ NO causar daÃ±o a usuarios reales

âœ… SÃ reportar vulnerabilidades responsablemente
âœ… SÃ usar solo en testnets o forks locales
âœ… SÃ seguir las reglas del programa de bug bounty

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          ğŸŸª Happy Hunting! ğŸŸª
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
